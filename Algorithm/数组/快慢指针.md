
```
// 时间复杂度：O(n)
// 空间复杂度：O(1)
class Solution {
public:
    int removeElement(vector<int>& nums, int val) {
        int slowIndex = 0;
        for (int fastIndex = 0; fastIndex < nums.size(); fastIndex++) {
            if (val != nums[fastIndex]) {
                nums[slowIndex++] = nums[fastIndex];
            }
        }
        return slowIndex;
    }
};
```
### 代码解析：利用快慢指针移除数组元素

这段 C++ 代码提供了一个高效的解决方案，用于从数组 nums 中**原地**移除所有等于 val 的元素，并返回新数组的长度。其核心思想巧妙地运用了**快慢指针**（在数组中也常称为双指针）技术。

#### 核心概念：快慢指针

快慢指针是一种常见的算法技巧，它使用两个指针以不同速度或在不同条件下遍历数据结构，从而解决问题。在这个特定的例子中，两个指针在同一个方向上移动，但它们的更新条件不同。

- **快指针 (fastIndex)**：它的任务是遍历整个数组，从头到尾检查每一个元素。
    
- **慢指针 (slowIndex)**：它的作用是标记新数组（即移除了目标值 val 后的数组）的末尾。只有当快指针指向的元素**不等于** val 时，慢指针才会移动。
    

#### 代码执行流程

1. **初始化**：
    
    - slowIndex 初始化为 0。它代表新数组的第一个位置，等待被填入有效的元素。
        
2. **遍历与赋值**：
    
    - fastIndex 通过 for 循环从 0 开始遍历整个 nums 数组。
        
    - 在循环的每一步，都会检查 nums[fastIndex] 的值。
        
    - **关键判断**：如果 nums[fastIndex] 的值 **不等于** val，说明这是一个需要保留的元素。
        
3. **原地修改**：
    
    - 当找到一个需要保留的元素时，就将 nums[fastIndex] 的值赋给 nums[slowIndex]。
        
    - 赋值完成后，slowIndex 会自增 1 (slowIndex++)，为下一个需要保留的元素准备好位置。
        
4. **返回结果**：
    
    - 当 for 循环结束时，fastIndex 已经遍历完整个数组。
        
    - 此时，slowIndex 的值恰好就是新数组的长度，因为它每成功放入一个有效元素就加一。所有从 0到 slowIndex - 1 的位置都被有效元素占据了。
        
    - 函数最终返回 slowIndex。
        

#### 举例说明

假设 nums = [0, 1, 2, 2, 3, 0, 4, 2] 并且 val = 2。

|           |                 |                             |                                                                                                                                                                                                                                                                                                                                                          |                          |           |
| --------- | --------------- | --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ | --------- |
| fastIndex | nums[fastIndex] | 判断 (val != nums[fastIndex]) | 操作                                                                                                                                                                                                                                                                                                                                                       | nums 数组状态                | slowIndex |
| 0         | 0               | true                        | nums = 0; slowIndex++;                                                                                                                                                                                                                                                                                                                                   | [0, 1, 2, 2, 3, 0, 4, 2] | 1         |
| 1         | 1               | true                        | nums[[2](https://www.google.com/url?sa=E&q=https%3A%2F%2Fvertexaisearch.cloud.google.com%2Fgrounding-api-redirect%2FAUZIYQEkWTXquNNDx9_dybU0KQUoFwkwGLom-dZ7d7BscIHZFTWkIrTotOchSP94LtMvgA6fu-ELwGznw_5JgG9q_dE66YHqJ2j2kxVt1v00TcHYclsBZg0Z2VS3ZKrI5_Xo8uQt4nuKY6FzVDHAot3rNgCljQw%3D)] = 1; slowIndex++;                                               | [0, 1, 2, 2, 3, 0, 4, 2] | 2         |
| 2         | 2               | false                       | 无                                                                                                                                                                                                                                                                                                                                                        | [0, 1, 2, 2, 3, 0, 4, 2] | 2         |
| 3         | 2               | false                       | 无                                                                                                                                                                                                                                                                                                                                                        | [0, 1, 2, 2, 3, 0, 4, 2] | 2         |
| 4         | 3               | true                        | nums[[3](https://www.google.com/url?sa=E&q=https%3A%2F%2Fvertexaisearch.cloud.google.com%2Fgrounding-api-redirect%2FAUZIYQFpQzXsp2Yl_gYbvLU-cCtbEFkPHnZYSvvUN4RBGuLr56W7dh-34PYPsXdAX3ZJmWBB6NuBRQR3Y5k6MujLiwD-iXYxP3849syMAhuuWW8En4GFGrCh2NhdbjtzlgDnpCbnMXN1bV77gnTbnScTuE6wzZ9isNslWF40uelGQBpGYWHzl6GT4Xg7qiJf7J44Drt6uFU57Kj9)] = 3; slowIndex++; | [0, 1, 3, 2, 3, 0, 4, 2] | 3         |
| 5         | 0               | true                        | nums[[4](https://www.google.com/url?sa=E&q=https%3A%2F%2Fvertexaisearch.cloud.google.com%2Fgrounding-api-redirect%2FAUZIYQHhg6C9xHLxKx9tVaIOGR0wRAypW0huK7mqZJZj0c1BfufwlZa7aIVAE3HTpySnxgD-0Pvx2yYyHjB8dBeG6RV5lqZaZ-ctLtstolRv2Oh736gcJQyRpzlrcGqa-QjwDS_abSgO70VbF4uxdl4liyMu-aC_LDDho8HPdEM6D9DsLmWaG7tkkpyQKRwcBjdwMdFOYas%3D)] = 0; slowIndex++;   | [0, 1, 3, 0, 3, 0, 4, 2] | 4         |
| 6         | 4               | true                        | nums[[5](https://www.google.com/url?sa=E&q=https%3A%2F%2Fvertexaisearch.cloud.google.com%2Fgrounding-api-redirect%2FAUZIYQGEoxU2nCzUAWBTBNTXY3sxwI3swiScOAVDP5lbiXnYmD6OOiD4rcwCrngpfZtscQ2XWL8wUHgJozo-5jTRdLBvWfd0Q2NcEvkRQ3MBh3cM1onYvsMBXEUPrFhXx23WvRXkSBIe2IvKmRtE5IK7GL5mU69W)] = 4; slowIndex++;                                                 | [0, 1, 3, 0, 4, 0, 4, 2] | 5         |
| 7         | 2               | false                       | 无                                                                                                                                                                                                                                                                                                                                                        | [0, 1, 3, 0, 4, 0, 4, 2] | 5         |

循环结束后，函数返回 slowIndex 的值 5。数组 nums 的前 5 个元素变为 [0, 1, 3, 0, 4]。[6]之后位置的元素是什么无关紧要。

#### 优势

这种方法非常高效，因为它只遍历数组一次，时间复杂度为 O(n)。同时，它是在原数组上进行修改，没有使用额外的数组空间，因此空间复杂度为 O(1)。

